import numpy as np
import pytest

from bblean.similarity import (
    jt_stratified_sampling,
    estimate_jt_std,
    jt_sim_matrix_packed,
)
from bblean.fingerprints import make_fake_fingerprints
from inline_snapshot import snapshot


def test_stratified() -> None:
    fps = make_fake_fingerprints(10, seed=1345)
    out = jt_stratified_sampling(fps, 3)
    assert out.tolist() == snapshot([0, 4, 2])

    assert jt_stratified_sampling(fps, 0).size == 0
    assert jt_stratified_sampling(fps, 10).tolist() == snapshot(
        [0, 9, 1, 5, 4, 3, 6, 2, 8, 7]
    )
    with pytest.raises(ValueError):
        _ = jt_stratified_sampling(fps, 11)


def test_sim_matrix() -> None:
    fps = make_fake_fingerprints(50, seed=1345)
    matrix = jt_sim_matrix_packed(fps)
    assert matrix.tolist() == snapshot(
        [
            [
                1.0,
                0.3735165521549032,
                0.27309782608695654,
                0.3231270358306189,
                0.35074145712443583,
                0.34635083226632524,
                0.29107981220657275,
                0.23104693140794225,
                0.259958071278826,
                0.39215686274509803,
                0.24912770411723656,
                0.24422673198040587,
                0.37933207309388783,
                0.19557195571955718,
                0.3962033067973056,
                0.25139664804469275,
                0.24416135881104034,
                0.3186306780776827,
                0.34243964421855144,
                0.44089834515366433,
                0.2240875912408759,
                0.4115586690017513,
                0.297554347826087,
                0.3795483061480552,
                0.20896601590744757,
                0.38930348258706465,
                0.06859504132231405,
                0.3196286472148541,
                0.2143874643874644,
                0.2875250166777852,
                0.1287758346581876,
                0.26888426888426886,
                0.31390728476821195,
                0.2924847664184157,
                0.27191166321601107,
                0.19419642857142858,
                0.3091884641180416,
                0.09364820846905537,
                0.36529968454258677,
                0.14992272024729522,
                0.2803801765105227,
                0.39952009598080385,
                0.13899920571882446,
                0.33648393194706994,
                0.39551786795881283,
                0.35800126502213786,
                0.49448732083792724,
                0.323238566131026,
                0.1656671664167916,
                0.21857142857142858,
            ],
            [
                0.3735165521549032,
                1.0,
                0.26851851851851855,
                0.3032952252858104,
                0.32319894249834763,
                0.3249835201054713,
                0.2802236198462614,
                0.22121212121212122,
                0.2328767123287671,
                0.3727882855399634,
                0.25147492625368734,
                0.23897058823529413,
                0.3240682248894504,
                0.19296875,
                0.36007462686567165,
                0.24926470588235294,
                0.2215700660308144,
                0.28706199460916443,
                0.3315754779169413,
                0.4050329538645896,
                0.19637462235649547,
                0.402291917973462,
                0.2877391920623671,
                0.32536186280679674,
                0.2035060975609756,
                0.35850253807106597,
                0.08010801080108011,
                0.2861016949152542,
                0.2129420617005267,
                0.2846153846153846,
                0.117003367003367,
                0.24946081955427749,
                0.305939226519337,
                0.26550522648083624,
                0.25538020086083213,
                0.17573872472783825,
                0.28918169209431344,
                0.09457092819614711,
                0.34655396618985695,
                0.13784665579119088,
                0.27615658362989326,
                0.37254901960784315,
                0.11936560934891485,
                0.33861386138613864,
                0.3572744014732965,
                0.33811074918566775,
                0.44561016013252347,
                0.3473684210526316,
                0.15939730372720062,
                0.21005251312828208,
            ],
            [
                0.27309782608695654,
                0.26851851851851855,
                1.0,
                0.24172440338722093,
                0.25617977528089886,
                0.2490733876945886,
                0.22620016273393004,
                0.1850828729281768,
                0.22026431718061673,
                0.2656147271531887,
                0.21201413427561838,
                0.20353982300884957,
                0.26409707351891504,
                0.16247582205029013,
                0.27534246575342464,
                0.2020997375328084,
                0.1795774647887324,
                0.23059006211180125,
                0.26209977661950856,
                0.29073482428115016,
                0.17007434944237917,
                0.3097576948264571,
                0.22798353909465022,
                0.27578796561604585,
                0.17746478873239438,
                0.2646239554317549,
                0.06060606060606061,
                0.23974763406940064,
                0.2084507042253521,
                0.21445783132530122,
                0.1258426966292135,
                0.21705426356589147,
                0.24780876494023904,
                0.22113022113022113,
                0.2076271186440678,
                0.1591796875,
                0.21456848772763262,
                0.07184241019698726,
                0.280997798972854,
                0.12869198312236288,
                0.20327868852459016,
                0.2707365627073656,
                0.11159737417943107,
                0.25775480059084194,
                0.26492287055667335,
                0.27601476014760146,
                0.328505214368482,
                0.260424286759327,
                0.13813813813813813,
                0.1741112123974476,
            ],
            [
                0.3231270358306189,
                0.3032952252858104,
                0.24172440338722093,
                1.0,
                0.300709219858156,
                0.2971830985915493,
                0.27411944869831545,
                0.19240297274979357,
                0.2199367088607595,
                0.32695984703632885,
                0.2222222222222222,
                0.20301348136399683,
                0.2930918846411804,
                0.19001751313485113,
                0.30342156229825695,
                0.22578062449959968,
                0.22303921568627452,
                0.27153284671532846,
                0.2914923291492329,
                0.33886838868388686,
                0.1949367088607595,
                0.3380893300248139,
                0.2665130568356375,
                0.3201634877384196,
                0.19273034657650043,
                0.3109634551495017,
                0.0694300518134715,
                0.25108538350217074,
                0.20534223706176963,
                0.25112443778110943,
                0.11764705882352941,
                0.2333071484681854,
                0.25218023255813954,
                0.23909774436090225,
                0.2407843137254902,
                0.17277486910994763,
                0.26666666666666666,
                0.0973630831643002,
                0.291044776119403,
                0.15103189493433397,
                0.24045801526717558,
                0.3472041612483745,
                0.12464046021093,
                0.3061797752808989,
                0.32404406999351915,
                0.29444063143445437,
                0.383399209486166,
                0.29120879120879123,
                0.14210061782877317,
                0.20116375727348296,
            ],
            [
                0.35074145712443583,
                0.32319894249834763,
                0.25617977528089886,
                0.300709219858156,
                1.0,
                0.30637422892392047,
                0.2677916360968452,
                0.21514907332796132,
                0.21299093655589124,
                0.3547979797979798,
                0.23297213622291021,
                0.23708920187793428,
                0.33244147157190634,
                0.19179229480737017,
                0.33099041533546325,
                0.24027993779160187,
                0.21384136858475894,
                0.27722772277227725,
                0.3177441540577717,
                0.37400367872470874,
                0.18875502008032127,
                0.3634131368937999,
                0.2755026061057334,
                0.33288948069241014,
                0.20703764320785598,
                0.3287671232876712,
                0.06511175898931001,
                0.27163120567375887,
                0.1930379746835443,
                0.2723935389133627,
                0.12201834862385322,
                0.23694171082513246,
                0.2791696492483894,
                0.24057971014492754,
                0.2507598784194529,
                0.184188393608074,
                0.28102189781021897,
                0.0821529745042493,
                0.31659973226238286,
                0.1384479717813051,
                0.24649446494464944,
                0.3501896333754741,
                0.12047101449275362,
                0.3205216197666438,
                0.3506410256410256,
                0.3026052104208417,
                0.4163380281690141,
                0.2934131736526946,
                0.15378079864061173,
                0.19572107765451663,
            ],
            [
                0.34635083226632524,
                0.3249835201054713,
                0.2490733876945886,
                0.2971830985915493,
                0.30637422892392047,
                1.0,
                0.25888324873096447,
                0.19747235387045814,
                0.2255125284738041,
                0.3487789605510332,
                0.22964669738863286,
                0.22608024691358025,
                0.3386880856760375,
                0.19449081803005008,
                0.3446945337620579,
                0.22741194486983154,
                0.21627906976744185,
                0.27926657263751764,
                0.3178082191780822,
                0.37217815741305676,
                0.2,
                0.35997559487492375,
                0.26265590608950845,
                0.32063074901445465,
                0.19789983844911146,
                0.33835078534031415,
                0.06563706563706563,
                0.29011461318051573,
                0.2176706827309237,
                0.2606806661839247,
                0.11705989110707804,
                0.24677296886864086,
                0.2730496453900709,
                0.2693726937269373,
                0.2473604826546003,
                0.18692372170997484,
                0.2574893009985735,
                0.0825515947467167,
                0.32996632996632996,
                0.12564991334488734,
                0.254249815225425,
                0.3475801382778127,
                0.12061206120612061,
                0.32057416267942584,
                0.3531669865642994,
                0.3096989966555184,
                0.4057971014492754,
                0.32070365358592695,
                0.16453537936913895,
                0.1935483870967742,
            ],
            [
                0.29107981220657275,
                0.2802236198462614,
                0.22620016273393004,
                0.27411944869831545,
                0.2677916360968452,
                0.25888324873096447,
                1.0,
                0.184070796460177,
                0.22108843537414966,
                0.3086092715231788,
                0.20797962648556875,
                0.19779286926994907,
                0.26791927627000695,
                0.1655813953488372,
                0.2899527983816588,
                0.2005054759898905,
                0.2180385288966725,
                0.23285606631499622,
                0.29333333333333333,
                0.30415617128463474,
                0.19525547445255476,
                0.31306017925736235,
                0.2344,
                0.26606772633033865,
                0.17673579801623085,
                0.28758620689655173,
                0.06559263521288838,
                0.2523148148148148,
                0.1989247311827957,
                0.23070866141732282,
                0.10725552050473186,
                0.20692497938994228,
                0.26328125,
                0.23261390887290168,
                0.22489626556016598,
                0.18129770992366412,
                0.24803149606299213,
                0.07252747252747253,
                0.2854077253218884,
                0.14621676891615543,
                0.225,
                0.2900262467191601,
                0.11261730969760167,
                0.25734767025089605,
                0.2965194109772423,
                0.2482468443197756,
                0.35023041474654376,
                0.2590489709013485,
                0.12606635071090047,
                0.18495575221238938,
            ],
            [
                0.23104693140794225,
                0.22121212121212122,
                0.1850828729281768,
                0.19240297274979357,
                0.21514907332796132,
                0.19747235387045814,
                0.184070796460177,
                1.0,
                0.16698656429942418,
                0.22369337979094076,
                0.18172888015717092,
                0.17224409448818898,
                0.2081447963800905,
                0.13766519823788545,
                0.21536252692031588,
                0.1802154750244858,
                0.1605550049554014,
                0.1889168765743073,
                0.19968553459119498,
                0.23235685752330226,
                0.15834218916046758,
                0.21823020625415834,
                0.19728506787330316,
                0.23335883703136956,
                0.15795090715048027,
                0.2154981549815498,
                0.04903417533432392,
                0.21788194444444445,
                0.1513903192584964,
                0.17497812773403323,
                0.11363636363636363,
                0.17803030303030304,
                0.19606164383561644,
                0.19529837251356238,
                0.16296296296296298,
                0.1273532668881506,
                0.19318181818181818,
                0.07692307692307693,
                0.22342901474010862,
                0.10552147239263804,
                0.19393382352941177,
                0.2287121745249824,
                0.10574412532637076,
                0.20125293657008614,
                0.22818311874105865,
                0.22448979591836735,
                0.26654740608228983,
                0.208398133748056,
                0.11649365628604383,
                0.1632016632016632,
            ],
            [
                0.259958071278826,
                0.2328767123287671,
                0.22026431718061673,
                0.2199367088607595,
                0.21299093655589124,
                0.2255125284738041,
                0.22108843537414966,
                0.16698656429942418,
                1.0,
                0.2612244897959184,
                0.1848816029143898,
                0.17288444040036396,
                0.2454212454212454,
                0.17567567567567569,
                0.2489539748953975,
                0.19322344322344323,
                0.18046511627906978,
                0.21606425702811244,
                0.22289156626506024,
                0.2623056994818653,
                0.16470588235294117,
                0.2665791201575837,
                0.20730671197960918,
                0.24363636363636362,
                0.1736111111111111,
                0.2411095305832148,
                0.06349206349206349,
                0.22831423895253683,
                0.1726133076181292,
                0.2018348623853211,
                0.11899038461538461,
                0.19395017793594305,
                0.23146622734761121,
                0.2033898305084746,
                0.20892857142857144,
                0.16371220020855057,
                0.21713810316139767,
                0.08513341804320203,
                0.24627976190476192,
                0.1326530612244898,
                0.21689895470383275,
                0.254421768707483,
                0.11045828437132785,
                0.2553846153846154,
                0.2692307692307692,
                0.23454951600893523,
                0.28587962962962965,
                0.2449133383571967,
                0.14010695187165775,
                0.1943081452404318,
            ],
            [
                0.39215686274509803,
                0.3727882855399634,
                0.2656147271531887,
                0.32695984703632885,
                0.3547979797979798,
                0.3487789605510332,
                0.3086092715231788,
                0.22369337979094076,
                0.2612244897959184,
                1.0,
                0.27140883977900554,
                0.2518822724161533,
                0.38016019716574245,
                0.19357142857142856,
                0.3866745984533016,
                0.258879781420765,
                0.25103734439834025,
                0.3294498381877023,
                0.3525,
                0.43128234617596317,
                0.21433591004919184,
                0.4157110091743119,
                0.2875902823374918,
                0.3786764705882353,
                0.20997191011235955,
                0.3992651561543172,
                0.06077348066298342,
                0.31932773109243695,
                0.22883135059482154,
                0.30931923331130207,
                0.12375859434682965,
                0.276797829036635,
                0.323146944083225,
                0.301460823373174,
                0.25680159256801594,
                0.19826338639652677,
                0.31086387434554974,
                0.09247648902821316,
                0.3647566235366605,
                0.16502649507948525,
                0.29912810194500333,
                0.40648967551622417,
                0.11570247933884298,
                0.3694829760403531,
                0.4034564958283671,
                0.36267823930564164,
                0.48017148981779206,
                0.36743605739238927,
                0.1731190650109569,
                0.22183588317107092,
            ],
            [
                0.24912770411723656,
                0.25147492625368734,
                0.21201413427561838,
                0.2222222222222222,
                0.23297213622291021,
                0.22964669738863286,
                0.20797962648556875,
                0.18172888015717092,
                0.1848816029143898,
                0.27140883977900554,
                1.0,
                0.18587360594795538,
                0.24044117647058824,
                0.14784394250513347,
                0.252112676056338,
                0.19113573407202217,
                0.17492984097287184,
                0.20950846091861403,
                0.23732718894009217,
                0.2795769993390615,
                0.1679920477137177,
                0.2714001327140013,
                0.2054794520547945,
                0.24322344322344322,
                0.15841584158415842,
                0.2478386167146974,
                0.05186170212765957,
                0.2267106347897774,
                0.1600771456123433,
                0.19899244332493704,
                0.11003627569528417,
                0.19192825112107623,
                0.21575061525840852,
                0.1974468085106383,
                0.20593525179856115,
                0.140641158221303,
                0.2154233025984912,
                0.07958921694480103,
                0.25150602409638556,
                0.11664779161947905,
                0.1920757967269595,
                0.2489768076398363,
                0.11483253588516747,
                0.24251726784343822,
                0.2522585128561501,
                0.24715693707354056,
                0.2887981330221704,
                0.23048048048048048,
                0.13714902807775378,
                0.176930596285435,
            ],
            [
                0.24422673198040587,
                0.23897058823529413,
                0.20353982300884957,
                0.20301348136399683,
                0.23708920187793428,
                0.22608024691358025,
                0.19779286926994907,
                0.17224409448818898,
                0.17288444040036396,
                0.2518822724161533,
                0.18587360594795538,
                1.0,
                0.23616236162361623,
                0.1402061855670103,
                0.26233023588277343,
                0.17140238313473877,
                0.17580340264650285,
                0.22854785478547854,
                0.2328450269853508,
                0.26996699669966995,
                0.17356205852674067,
                0.26764314247669774,
                0.20865800865800865,
                0.246301775147929,
                0.1744421906693712,
                0.2536443148688047,
                0.06566347469220246,
                0.22084367245657568,
                0.1630859375,
                0.20819112627986347,
                0.09818181818181818,
                0.1854185418541854,
                0.21789560894780446,
                0.19128949615713065,
                0.1972972972972973,
                0.1569459172852598,
                0.20536462699077954,
                0.08792650918635171,
                0.24153498871331827,
                0.11954022988505747,
                0.21631205673758866,
                0.26056826056826055,
                0.12195121951219512,
                0.23141762452107278,
                0.2508735150244584,
                0.22139117427075541,
                0.27658338175479374,
                0.23726235741444868,
                0.1145610278372591,
                0.18136769078295342,
            ],
            [
                0.37933207309388783,
                0.3240682248894504,
                0.26409707351891504,
                0.2930918846411804,
                0.33244147157190634,
                0.3386880856760375,
                0.26791927627000695,
                0.2081447963800905,
                0.2454212454212454,
                0.38016019716574245,
                0.24044117647058824,
                0.23616236162361623,
                1.0,
                0.18980392156862744,
                0.3589263420724095,
                0.21949458483754514,
                0.23877245508982037,
                0.30763936682725396,
                0.3214990138067061,
                0.4049338146811071,
                0.21638330757341576,
                0.3771564544913742,
                0.26275331935709295,
                0.3487773487773488,
                0.19315589353612167,
                0.33940917661847897,
                0.06726457399103139,
                0.29512697323266984,
                0.22570772762050498,
                0.2966643009226402,
                0.11989795918367346,
                0.24316546762589927,
                0.2918956043956044,
                0.26559215136650316,
                0.25360230547550433,
                0.19111816019032513,
                0.2778161713890809,
                0.08486439195100612,
                0.33053582956746286,
                0.1589958158995816,
                0.26723525230987916,
                0.3622480146609652,
                0.1289228159457167,
                0.34443704197201863,
                0.38427672955974845,
                0.3359477124183007,
                0.4480843975569128,
                0.3208036292935839,
                0.1757085020242915,
                0.21808510638297873,
            ],
            [
                0.19557195571955718,
                0.19296875,
                0.16247582205029013,
                0.19001751313485113,
                0.19179229480737017,
                0.19449081803005008,
                0.1655813953488372,
                0.13766519823788545,
                0.17567567567567569,
                0.19357142857142856,
                0.14784394250513347,
                0.1402061855670103,
                0.18980392156862744,
                1.0,
                0.19022945965951146,
                0.15942028985507245,
                0.14799154334038056,
                0.1695957820738137,
                0.19189412737799835,
                0.20054384772263767,
                0.12040133779264214,
                0.2033080634045486,
                0.16682375117813383,
                0.18097447795823665,
                0.15207373271889402,
                0.18243754731264195,
                0.050761421319796954,
                0.16843971631205673,
                0.1516164994425864,
                0.16697588126159554,
                0.0967741935483871,
                0.16016016016016016,
                0.16209034543844109,
                0.17140151515151514,
                0.16401590457256462,
                0.10023584905660378,
                0.170018281535649,
                0.07704654895666131,
                0.1888446215139442,
                0.10270270270270271,
                0.1673076923076923,
                0.1932471264367816,
                0.09640287769784173,
                0.19851116625310175,
                0.20088300220750552,
                0.18,
                0.21080760095011877,
                0.19140308191403083,
                0.12055837563451777,
                0.16179775280898875,
            ],
            [
                0.3962033067973056,
                0.36007462686567165,
                0.27534246575342464,
                0.30342156229825695,
                0.33099041533546325,
                0.3446945337620579,
                0.2899527983816588,
                0.21536252692031588,
                0.2489539748953975,
                0.3866745984533016,
                0.252112676056338,
                0.26233023588277343,
                0.3589263420724095,
                0.19022945965951146,
                1.0,
                0.2544045102184637,
                0.23742026931254429,
                0.3064304461942257,
                0.3399234693877551,
                0.41292952824694235,
                0.21532846715328466,
                0.4144620811287478,
                0.28329952670723463,
                0.3634663341645885,
                0.2063953488372093,
                0.37330037082818296,
                0.07017543859649122,
                0.3151595744680851,
                0.22770123277737492,
                0.2950708980418636,
                0.12012728719172633,
                0.2579529737206086,
                0.3007915567282322,
                0.29488054607508535,
                0.27152777777777776,
                0.1986455981941309,
                0.29852744310575635,
                0.07860615883306321,
                0.35516372795969775,
                0.13801079414032383,
                0.27309782608695654,
                0.3823704586063133,
                0.12056737588652482,
                0.33904761904761904,
                0.39416058394160586,
                0.35641677255400256,
                0.4845984598459846,
                0.344914718888187,
                0.1636500754147813,
                0.21782890007189074,
            ],
            [
                0.25139664804469275,
                0.24926470588235294,
                0.2020997375328084,
                0.22578062449959968,
                0.24027993779160187,
                0.22741194486983154,
                0.2005054759898905,
                0.1802154750244858,
                0.19322344322344323,
                0.258879781420765,
                0.19113573407202217,
                0.17140238313473877,
                0.21949458483754514,
                0.15942028985507245,
                0.2544045102184637,
                1.0,
                0.1812206572769953,
                0.20917135961383748,
                0.23696319018404907,
                0.2733245729303548,
                0.15053763440860216,
                0.2544146500981033,
                0.21761658031088082,
                0.23924142961342085,
                0.16616915422885573,
                0.23416370106761566,
                0.06016042780748663,
                0.22532894736842105,
                0.16200578592092574,
                0.19966442953020133,
                0.0991636798088411,
                0.19051878354203935,
                0.2153972153972154,
                0.20324508966695132,
                0.18430335097001763,
                0.12870275791624106,
                0.22016806722689075,
                0.09055627425614489,
                0.24271844660194175,
                0.13172966781214204,
                0.22438162544169613,
                0.2650103519668737,
                0.09239766081871345,
                0.22803030303030303,
                0.25977653631284914,
                0.24772727272727274,
                0.28846153846153844,
                0.24980959634424982,
                0.14301191765980498,
                0.1686046511627907,
            ],
            [
                0.24416135881104034,
                0.2215700660308144,
                0.1795774647887324,
                0.22303921568627452,
                0.21384136858475894,
                0.21627906976744185,
                0.2180385288966725,
                0.1605550049554014,
                0.18046511627906978,
                0.25103734439834025,
                0.17492984097287184,
                0.17580340264650285,
                0.23877245508982037,
                0.14799154334038056,
                0.23742026931254429,
                0.1812206572769953,
                1.0,
                0.19043760129659643,
                0.22688422688422688,
                0.24934383202099739,
                0.17835051546391753,
                0.26698049764626763,
                0.20595968448729185,
                0.24532535527299926,
                0.16359918200409,
                0.23726346433770015,
                0.06302521008403361,
                0.1944216570959803,
                0.16633466135458166,
                0.21180555555555555,
                0.08845208845208845,
                0.19759926131117267,
                0.2033195020746888,
                0.19461337966985232,
                0.1987179487179487,
                0.1540948275862069,
                0.21612349914236706,
                0.07152317880794702,
                0.22740963855421686,
                0.1276595744680851,
                0.18909410729991205,
                0.25453277545327757,
                0.12359550561797752,
                0.21889400921658986,
                0.24123422159887797,
                0.2322383498854087,
                0.2768328445747801,
                0.21009036144578314,
                0.12942477876106195,
                0.1626984126984127,
            ],
            [
                0.3186306780776827,
                0.28706199460916443,
                0.23059006211180125,
                0.27153284671532846,
                0.27722772277227725,
                0.27926657263751764,
                0.23285606631499622,
                0.1889168765743073,
                0.21606425702811244,
                0.3294498381877023,
                0.20950846091861403,
                0.22854785478547854,
                0.30763936682725396,
                0.1695957820738137,
                0.3064304461942257,
                0.20917135961383748,
                0.19043760129659643,
                1.0,
                0.2782060266292922,
                0.3372744243932794,
                0.21222707423580786,
                0.33229036295369213,
                0.2469230769230769,
                0.3082191780821918,
                0.1974025974025974,
                0.30274614869390487,
                0.08306364617044229,
                0.26940298507462684,
                0.19796954314720813,
                0.25554705432287683,
                0.1253731343283582,
                0.22478157267672755,
                0.2811791383219955,
                0.23193916349809887,
                0.24121405750798722,
                0.17290552584670232,
                0.2522590361445783,
                0.09449636552440291,
                0.2966804979253112,
                0.12900188323917136,
                0.24376947040498442,
                0.32555123216601817,
                0.12586037364798427,
                0.26869806094182824,
                0.3075924724205062,
                0.2902777777777778,
                0.3714609286523216,
                0.29964912280701755,
                0.15934065934065933,
                0.19477234401349072,
            ],
            [
                0.34243964421855144,
                0.3315754779169413,
                0.26209977661950856,
                0.2914923291492329,
                0.3177441540577717,
                0.3178082191780822,
                0.29333333333333333,
                0.19968553459119498,
                0.22289156626506024,
                0.3525,
                0.23732718894009217,
                0.2328450269853508,
                0.3214990138067061,
                0.19189412737799835,
                0.3399234693877551,
                0.23696319018404907,
                0.22688422688422688,
                0.2782060266292922,
                1.0,
                0.36577992744860943,
                0.1964856230031949,
                0.36109422492401216,
                0.26720351390922403,
                0.32807363576594345,
                0.19631410256410256,
                0.3283775048480931,
                0.054924242424242424,
                0.278954802259887,
                0.21015067406819984,
                0.2753095411507647,
                0.11600719424460432,
                0.24397590361445784,
                0.2883654532476802,
                0.2664714494875549,
                0.2511278195488722,
                0.1631321370309951,
                0.2727925340990668,
                0.08379888268156424,
                0.3067807768268598,
                0.16046099290780141,
                0.2616407982261641,
                0.35984848484848486,
                0.12053571428571429,
                0.3148273527420447,
                0.33647798742138363,
                0.3137516688918558,
                0.4066666666666667,
                0.32836831415030465,
                0.16610169491525423,
                0.2138314785373609,
            ],
            [
                0.44089834515366433,
                0.4050329538645896,
                0.29073482428115016,
                0.33886838868388686,
                0.37400367872470874,
                0.37217815741305676,
                0.30415617128463474,
                0.23235685752330226,
                0.2623056994818653,
                0.43128234617596317,
                0.2795769993390615,
                0.26996699669966995,
                0.4049338146811071,
                0.20054384772263767,
                0.41292952824694235,
                0.2733245729303548,
                0.24934383202099739,
                0.3372744243932794,
                0.36577992744860943,
                1.0,
                0.21290751829673984,
                0.4593056346044394,
                0.3145780051150895,
                0.4,
                0.21768251841929,
                0.4099526066350711,
                0.06829992576095026,
                0.32753262896208823,
                0.2473045822102426,
                0.31309297912713474,
                0.125,
                0.280440414507772,
                0.327930174563591,
                0.3114231014677728,
                0.2782776349614396,
                0.18792401628222524,
                0.3219911783238815,
                0.09565857247976453,
                0.3940856970428485,
                0.15722379603399433,
                0.315210355987055,
                0.425531914893617,
                0.14244396240057844,
                0.3591127098321343,
                0.44287396937573614,
                0.38382619191309597,
                0.5376749192680301,
                0.3629320619785459,
                0.17634854771784234,
                0.23384410393071287,
            ],
            [
                0.2240875912408759,
                0.19637462235649547,
                0.17007434944237917,
                0.1949367088607595,
                0.18875502008032127,
                0.2,
                0.19525547445255476,
                0.15834218916046758,
                0.16470588235294117,
                0.21433591004919184,
                0.1679920477137177,
                0.17356205852674067,
                0.21638330757341576,
                0.12040133779264214,
                0.21532846715328466,
                0.15053763440860216,
                0.17835051546391753,
                0.21222707423580786,
                0.1964856230031949,
                0.21290751829673984,
                1.0,
                0.223202170963365,
                0.18698441796516957,
                0.20456273764258556,
                0.15772179627601315,
                0.2237339380196523,
                0.0694006309148265,
                0.19254119687771032,
                0.17078410311493017,
                0.19654231119199272,
                0.09822646657571624,
                0.17943743937924345,
                0.1690862510674637,
                0.1721014492753623,
                0.19107662463627545,
                0.14982578397212543,
                0.17797356828193833,
                0.08333333333333333,
                0.20357420357420358,
                0.10927573062261753,
                0.1812267657992565,
                0.22277580071174377,
                0.08620689655172414,
                0.18025078369905956,
                0.22125813449023862,
                0.19968676585747847,
                0.23730814639905548,
                0.21400159108989658,
                0.12305854241338113,
                0.13174273858921162,
            ],
            [
                0.4115586690017513,
                0.402291917973462,
                0.3097576948264571,
                0.3380893300248139,
                0.3634131368937999,
                0.35997559487492375,
                0.31306017925736235,
                0.21823020625415834,
                0.2665791201575837,
                0.4157110091743119,
                0.2714001327140013,
                0.26764314247669774,
                0.3771564544913742,
                0.2033080634045486,
                0.4144620811287478,
                0.2544146500981033,
                0.26698049764626763,
                0.33229036295369213,
                0.36109422492401216,
                0.4593056346044394,
                0.223202170963365,
                1.0,
                0.30095846645367413,
                0.39055023923444976,
                0.2256305385139741,
                0.4064362336114422,
                0.0693293142426526,
                0.3258145363408521,
                0.23716216216216215,
                0.31626120358514725,
                0.12518195050946143,
                0.26421188630490955,
                0.34480560866794135,
                0.31121134020618557,
                0.28273615635179156,
                0.1921487603305785,
                0.3244104525175271,
                0.09381980640357408,
                0.3778580024067389,
                0.15121255349500715,
                0.2972275950999355,
                0.43801169590643274,
                0.1328976034858388,
                0.37937384898710863,
                0.41525917297612114,
                0.3817629179331307,
                0.5179240235420011,
                0.3856968215158924,
                0.18882602545968882,
                0.24625850340136055,
            ],
            [
                0.297554347826087,
                0.2877391920623671,
                0.22798353909465022,
                0.2665130568356375,
                0.2755026061057334,
                0.26265590608950845,
                0.2344,
                0.19728506787330316,
                0.20730671197960918,
                0.2875902823374918,
                0.2054794520547945,
                0.20865800865800865,
                0.26275331935709295,
                0.16682375117813383,
                0.28329952670723463,
                0.21761658031088082,
                0.20595968448729185,
                0.2469230769230769,
                0.26720351390922403,
                0.3145780051150895,
                0.18698441796516957,
                0.30095846645367413,
                1.0,
                0.2777777777777778,
                0.17166212534059946,
                0.2816608996539792,
                0.06301050175029171,
                0.2426584234930448,
                0.18867924528301888,
                0.2217837411207577,
                0.12095032397408208,
                0.2125523012552301,
                0.22664624808575803,
                0.22650602409638554,
                0.2175,
                0.16698473282442747,
                0.2401263823064771,
                0.07856341189674523,
                0.27467811158798283,
                0.11491935483870967,
                0.22875816993464052,
                0.28949107732980833,
                0.10970464135021098,
                0.2730600292825769,
                0.2813333333333333,
                0.2661406025824964,
                0.34936268829663963,
                0.2700361010830325,
                0.13773035887487875,
                0.17898486197684774,
            ],
            [
                0.3795483061480552,
                0.32536186280679674,
                0.27578796561604585,
                0.3201634877384196,
                0.33288948069241014,
                0.32063074901445465,
                0.26606772633033865,
                0.23335883703136956,
                0.24363636363636362,
                0.3786764705882353,
                0.24322344322344322,
                0.246301775147929,
                0.3487773487773488,
                0.18097447795823665,
                0.3634663341645885,
                0.23924142961342085,
                0.24532535527299926,
                0.3082191780821918,
                0.32807363576594345,
                0.4,
                0.20456273764258556,
                0.39055023923444976,
                0.2777777777777778,
                1.0,
                0.2155504234026174,
                0.3680511182108626,
                0.06571936056838366,
                0.2966507177033493,
                0.21385542168674698,
                0.2819260293091417,
                0.11232187761944677,
                0.24946081955427749,
                0.2907849829351536,
                0.28885734563520227,
                0.27180232558139533,
                0.18681318681318682,
                0.2811853893866299,
                0.10326566637246248,
                0.3241687979539642,
                0.14063777596075225,
                0.25912921348314605,
                0.3810110974106042,
                0.13069139966273188,
                0.33508887425938116,
                0.3631319358816276,
                0.32601678502259523,
                0.4345205479452055,
                0.3272845106934543,
                0.16031746031746033,
                0.20193740685543965,
            ],
            [
                0.20896601590744757,
                0.2035060975609756,
                0.17746478873239438,
                0.19273034657650043,
                0.20703764320785598,
                0.19789983844911146,
                0.17673579801623085,
                0.15795090715048027,
                0.1736111111111111,
                0.20997191011235955,
                0.15841584158415842,
                0.1744421906693712,
                0.19315589353612167,
                0.15207373271889402,
                0.2063953488372093,
                0.16616915422885573,
                0.16359918200409,
                0.1974025974025974,
                0.19631410256410256,
                0.21768251841929,
                0.15772179627601315,
                0.2256305385139741,
                0.17166212534059946,
                0.2155504234026174,
                1.0,
                0.2255125284738041,
                0.05984251968503937,
                0.1620016963528414,
                0.15918803418803418,
                0.17699910152740342,
                0.08843537414965986,
                0.17458777885548013,
                0.19230769230769232,
                0.17824497257769653,
                0.171455938697318,
                0.12571428571428572,
                0.18294849023090587,
                0.07111111111111111,
                0.2128829536527887,
                0.12435233160621761,
                0.17548746518105848,
                0.22357142857142856,
                0.10597826086956522,
                0.2008,
                0.22294843863471314,
                0.19670846394984326,
                0.23217442545668826,
                0.19387755102040816,
                0.10781990521327015,
                0.16025641025641027,
            ],
            [
                0.38930348258706465,
                0.35850253807106597,
                0.2646239554317549,
                0.3109634551495017,
                0.3287671232876712,
                0.33835078534031415,
                0.28758620689655173,
                0.2154981549815498,
                0.2411095305832148,
                0.3992651561543172,
                0.2478386167146974,
                0.2536443148688047,
                0.33940917661847897,
                0.18243754731264195,
                0.37330037082818296,
                0.23416370106761566,
                0.23726346433770015,
                0.30274614869390487,
                0.3283775048480931,
                0.4099526066350711,
                0.2237339380196523,
                0.4064362336114422,
                0.2816608996539792,
                0.3680511182108626,
                0.2255125284738041,
                1.0,
                0.06741573033707865,
                0.30628803245436104,
                0.22,
                0.2955017301038062,
                0.11183673469387755,
                0.24771287825475016,
                0.29348556077904636,
                0.2730398899587345,
                0.26416430594900847,
                0.18726016884113583,
                0.3035099793530626,
                0.08622147083685545,
                0.35695876288659795,
                0.1532258064516129,
                0.2712100139082058,
                0.37130801687763715,
                0.13157894736842105,
                0.3352750809061489,
                0.3720219914477703,
                0.33312061263560944,
                0.4544956140350877,
                0.3447385409941898,
                0.1649805447470817,
                0.22255192878338279,
            ],
            [
                0.06859504132231405,
                0.08010801080108011,
                0.06060606060606061,
                0.0694300518134715,
                0.06511175898931001,
                0.06563706563706563,
                0.06559263521288838,
                0.04903417533432392,
                0.06349206349206349,
                0.06077348066298342,
                0.05186170212765957,
                0.06566347469220246,
                0.06726457399103139,
                0.050761421319796954,
                0.07017543859649122,
                0.06016042780748663,
                0.06302521008403361,
                0.08306364617044229,
                0.054924242424242424,
                0.06829992576095026,
                0.0694006309148265,
                0.0693293142426526,
                0.06301050175029171,
                0.06571936056838366,
                0.05984251968503937,
                0.06741573033707865,
                1.0,
                0.06903991370010787,
                0.04437869822485207,
                0.07258064516129033,
                0.04466501240694789,
                0.06940874035989718,
                0.05460385438972163,
                0.06060606060606061,
                0.06030150753768844,
                0.046632124352331605,
                0.07078651685393259,
                0.04242424242424243,
                0.06684981684981685,
                0.04487179487179487,
                0.06867469879518072,
                0.0749395648670427,
                0.053268765133171914,
                0.07163323782234957,
                0.06792144026186579,
                0.06592386258124419,
                0.07470182046453233,
                0.07230046948356808,
                0.045112781954887216,
                0.05522388059701493,
            ],
            [
                0.3196286472148541,
                0.2861016949152542,
                0.23974763406940064,
                0.25108538350217074,
                0.27163120567375887,
                0.29011461318051573,
                0.2523148148148148,
                0.21788194444444445,
                0.22831423895253683,
                0.31932773109243695,
                0.2267106347897774,
                0.22084367245657568,
                0.29512697323266984,
                0.16843971631205673,
                0.3151595744680851,
                0.22532894736842105,
                0.1944216570959803,
                0.26940298507462684,
                0.278954802259887,
                0.32753262896208823,
                0.19254119687771032,
                0.3258145363408521,
                0.2426584234930448,
                0.2966507177033493,
                0.1620016963528414,
                0.30628803245436104,
                0.06903991370010787,
                1.0,
                0.20222793487574978,
                0.2571428571428571,
                0.1157684630738523,
                0.22417934347477983,
                0.2684766214177979,
                0.24188562596599691,
                0.2508116883116883,
                0.17176258992805754,
                0.24434389140271492,
                0.09233997901364113,
                0.2814865794907089,
                0.14478764478764478,
                0.23653395784543327,
                0.32054616384915474,
                0.10546875,
                0.2800844475721323,
                0.3258278145695364,
                0.2920168067226891,
                0.3679727427597956,
                0.29507042253521126,
                0.1422060164083865,
                0.2103448275862069,
            ],
            [
                0.2143874643874644,
                0.2129420617005267,
                0.2084507042253521,
                0.20534223706176963,
                0.1930379746835443,
                0.2176706827309237,
                0.1989247311827957,
                0.1513903192584964,
                0.1726133076181292,
                0.22883135059482154,
                0.1600771456123433,
                0.1630859375,
                0.22570772762050498,
                0.1516164994425864,
                0.22770123277737492,
                0.16200578592092574,
                0.16633466135458166,
                0.19796954314720813,
                0.21015067406819984,
                0.2473045822102426,
                0.17078410311493017,
                0.23716216216216215,
                0.18867924528301888,
                0.21385542168674698,
                0.15918803418803418,
                0.22,
                0.04437869822485207,
                0.20222793487574978,
                1.0,
                0.19803746654772525,
                0.10039630118890357,
                0.1702728127939793,
                0.18893617021276596,
                0.18991899189918993,
                0.18156161806208843,
                0.1412556053811659,
                0.18181818181818182,
                0.07692307692307693,
                0.2187017001545595,
                0.08816425120772947,
                0.20277777777777778,
                0.21165857043719638,
                0.10143042912873862,
                0.2059748427672956,
                0.22994269340974213,
                0.21495327102803738,
                0.24283206553540082,
                0.2188235294117647,
                0.13615023474178403,
                0.15360824742268042,
            ],
            [
                0.2875250166777852,
                0.2846153846153846,
                0.21445783132530122,
                0.25112443778110943,
                0.2723935389133627,
                0.2606806661839247,
                0.23070866141732282,
                0.17497812773403323,
                0.2018348623853211,
                0.30931923331130207,
                0.19899244332493704,
                0.20819112627986347,
                0.2966643009226402,
                0.16697588126159554,
                0.2950708980418636,
                0.19966442953020133,
                0.21180555555555555,
                0.25554705432287683,
                0.2753095411507647,
                0.31309297912713474,
                0.19654231119199272,
                0.31626120358514725,
                0.2217837411207577,
                0.2819260293091417,
                0.17699910152740342,
                0.2955017301038062,
                0.07258064516129033,
                0.2571428571428571,
                0.19803746654772525,
                1.0,
                0.1090146750524109,
                0.2262103505843072,
                0.24769230769230768,
                0.23266932270916335,
                0.20700896495517523,
                0.1616822429906542,
                0.24315871774824083,
                0.08158765159867695,
                0.2654494382022472,
                0.14198782961460446,
                0.24205378973105135,
                0.2958579881656805,
                0.1248688352570829,
                0.2830051057622174,
                0.3148273527420447,
                0.2841726618705036,
                0.3301245753114383,
                0.2563559322033898,
                0.15937803692905733,
                0.1883289124668435,
            ],
            [
                0.1287758346581876,
                0.117003367003367,
                0.1258426966292135,
                0.11764705882352941,
                0.12201834862385322,
                0.11705989110707804,
                0.10725552050473186,
                0.11363636363636363,
                0.11899038461538461,
                0.12375859434682965,
                0.11003627569528417,
                0.09818181818181818,
                0.11989795918367346,
                0.0967741935483871,
                0.12012728719172633,
                0.0991636798088411,
                0.08845208845208845,
                0.1253731343283582,
                0.11600719424460432,
                0.125,
                0.09822646657571624,
                0.12518195050946143,
                0.12095032397408208,
                0.11232187761944677,
                0.08843537414965986,
                0.11183673469387755,
                0.04466501240694789,
                0.1157684630738523,
                0.10039630118890357,
                0.1090146750524109,
                1.0,
                0.09725400457665904,
                0.10536779324055666,
                0.11146838156484459,
                0.09841628959276018,
                0.09730538922155689,
                0.11225540679711637,
                0.06320541760722348,
                0.1363236587510994,
                0.10196779964221825,
                0.11062431544359255,
                0.13608087091757387,
                0.06844106463878327,
                0.10726950354609929,
                0.12667191188040913,
                0.12533097969991175,
                0.1316923076923077,
                0.12599822537710736,
                0.0928,
                0.10317460317460317,
            ],
            [
                0.26888426888426886,
                0.24946081955427749,
                0.21705426356589147,
                0.2333071484681854,
                0.23694171082513246,
                0.24677296886864086,
                0.20692497938994228,
                0.17803030303030304,
                0.19395017793594305,
                0.276797829036635,
                0.19192825112107623,
                0.1854185418541854,
                0.24316546762589927,
                0.16016016016016016,
                0.2579529737206086,
                0.19051878354203935,
                0.19759926131117267,
                0.22478157267672755,
                0.24397590361445784,
                0.280440414507772,
                0.17943743937924345,
                0.26421188630490955,
                0.2125523012552301,
                0.24946081955427749,
                0.17458777885548013,
                0.24771287825475016,
                0.06940874035989718,
                0.22417934347477983,
                0.1702728127939793,
                0.2262103505843072,
                0.09725400457665904,
                1.0,
                0.24428104575163398,
                0.21988205560235888,
                0.21654929577464788,
                0.1394422310756972,
                0.22113022113022113,
                0.0795593635250918,
                0.24853372434017595,
                0.12609649122807018,
                0.20558375634517767,
                0.27346938775510204,
                0.1082004555808656,
                0.26717557251908397,
                0.2780859916782247,
                0.26957831325301207,
                0.3119533527696793,
                0.26601356443104746,
                0.16012725344644752,
                0.15598885793871867,
            ],
            [
                0.31390728476821195,
                0.305939226519337,
                0.24780876494023904,
                0.25218023255813954,
                0.2791696492483894,
                0.2730496453900709,
                0.26328125,
                0.19606164383561644,
                0.23146622734761121,
                0.323146944083225,
                0.21575061525840852,
                0.21789560894780446,
                0.2918956043956044,
                0.16209034543844109,
                0.3007915567282322,
                0.2153972153972154,
                0.2033195020746888,
                0.2811791383219955,
                0.2883654532476802,
                0.327930174563591,
                0.1690862510674637,
                0.34480560866794135,
                0.22664624808575803,
                0.2907849829351536,
                0.19230769230769232,
                0.29348556077904636,
                0.05460385438972163,
                0.2684766214177979,
                0.18893617021276596,
                0.24769230769230768,
                0.10536779324055666,
                0.24428104575163398,
                1.0,
                0.227760736196319,
                0.23392282958199356,
                0.16427289048473967,
                0.2530487804878049,
                0.09292502639915523,
                0.28888888888888886,
                0.13789778206364514,
                0.2376470588235294,
                0.3166449934980494,
                0.10500490677134446,
                0.2867281760113556,
                0.316622691292876,
                0.29324894514767935,
                0.3515185601799775,
                0.2702702702702703,
                0.16542056074766356,
                0.1958939264328486,
            ],
            [
                0.2924847664184157,
                0.26550522648083624,
                0.22113022113022113,
                0.23909774436090225,
                0.24057971014492754,
                0.2693726937269373,
                0.23261390887290168,
                0.19529837251356238,
                0.2033898305084746,
                0.301460823373174,
                0.1974468085106383,
                0.19128949615713065,
                0.26559215136650316,
                0.17140151515151514,
                0.29488054607508535,
                0.20324508966695132,
                0.19461337966985232,
                0.23193916349809887,
                0.2664714494875549,
                0.3114231014677728,
                0.1721014492753623,
                0.31121134020618557,
                0.22650602409638554,
                0.28885734563520227,
                0.17824497257769653,
                0.2730398899587345,
                0.06060606060606061,
                0.24188562596599691,
                0.18991899189918993,
                0.23266932270916335,
                0.11146838156484459,
                0.21988205560235888,
                0.227760736196319,
                1.0,
                0.20164609053497942,
                0.16491897044804577,
                0.23835832675611682,
                0.07262569832402235,
                0.27945402298850575,
                0.1415289256198347,
                0.21307506053268765,
                0.29740518962075846,
                0.1109936575052854,
                0.2612481857764877,
                0.285809906291834,
                0.2546230440967283,
                0.33793103448275863,
                0.26931407942238267,
                0.15924826904055392,
                0.194043321299639,
            ],
            [
                0.27191166321601107,
                0.25538020086083213,
                0.2076271186440678,
                0.2407843137254902,
                0.2507598784194529,
                0.2473604826546003,
                0.22489626556016598,
                0.16296296296296298,
                0.20892857142857144,
                0.25680159256801594,
                0.20593525179856115,
                0.1972972972972973,
                0.25360230547550433,
                0.16401590457256462,
                0.27152777777777776,
                0.18430335097001763,
                0.1987179487179487,
                0.24121405750798722,
                0.2511278195488722,
                0.2782776349614396,
                0.19107662463627545,
                0.28273615635179156,
                0.2175,
                0.27180232558139533,
                0.171455938697318,
                0.26416430594900847,
                0.06030150753768844,
                0.2508116883116883,
                0.18156161806208843,
                0.20700896495517523,
                0.09841628959276018,
                0.21654929577464788,
                0.23392282958199356,
                0.20164609053497942,
                1.0,
                0.1700404858299595,
                0.2033626901521217,
                0.07971014492753623,
                0.24005784526391902,
                0.11720430107526882,
                0.21163575042158517,
                0.2825051055139551,
                0.11173814898419865,
                0.23851851851851852,
                0.26621160409556316,
                0.252212389380531,
                0.31130434782608696,
                0.2514792899408284,
                0.14256198347107438,
                0.1660482374768089,
            ],
            [
                0.19419642857142858,
                0.17573872472783825,
                0.1591796875,
                0.17277486910994763,
                0.184188393608074,
                0.18692372170997484,
                0.18129770992366412,
                0.1273532668881506,
                0.16371220020855057,
                0.19826338639652677,
                0.140641158221303,
                0.1569459172852598,
                0.19111816019032513,
                0.10023584905660378,
                0.1986455981941309,
                0.12870275791624106,
                0.1540948275862069,
                0.17290552584670232,
                0.1631321370309951,
                0.18792401628222524,
                0.14982578397212543,
                0.1921487603305785,
                0.16698473282442747,
                0.18681318681318682,
                0.12571428571428572,
                0.18726016884113583,
                0.046632124352331605,
                0.17176258992805754,
                0.1412556053811659,
                0.1616822429906542,
                0.09730538922155689,
                0.1394422310756972,
                0.16427289048473967,
                0.16491897044804577,
                0.1700404858299595,
                1.0,
                0.1669741697416974,
                0.09151414309484193,
                0.19016921837228043,
                0.09726027397260274,
                0.15177713736791545,
                0.19361856417693982,
                0.0841799709724238,
                0.18610421836228289,
                0.19335793357933578,
                0.16706634692246203,
                0.2119760479041916,
                0.17542441390460792,
                0.10292249047013977,
                0.13348164627363737,
            ],
            [
                0.3091884641180416,
                0.28918169209431344,
                0.21456848772763262,
                0.26666666666666666,
                0.28102189781021897,
                0.2574893009985735,
                0.24803149606299213,
                0.19318181818181818,
                0.21713810316139767,
                0.31086387434554974,
                0.2154233025984912,
                0.20536462699077954,
                0.2778161713890809,
                0.170018281535649,
                0.29852744310575635,
                0.22016806722689075,
                0.21612349914236706,
                0.2522590361445783,
                0.2727925340990668,
                0.3219911783238815,
                0.17797356828193833,
                0.3244104525175271,
                0.2401263823064771,
                0.2811853893866299,
                0.18294849023090587,
                0.3035099793530626,
                0.07078651685393259,
                0.24434389140271492,
                0.18181818181818182,
                0.24315871774824083,
                0.11225540679711637,
                0.22113022113022113,
                0.2530487804878049,
                0.23835832675611682,
                0.2033626901521217,
                0.1669741697416974,
                1.0,
                0.08198489751887811,
                0.2836030964109782,
                0.1377601585728444,
                0.2231012658227848,
                0.30346631785480704,
                0.11746680286006128,
                0.2703281027104137,
                0.30066225165562915,
                0.265406162464986,
                0.3456299659477866,
                0.2709950599858857,
                0.17052023121387283,
                0.18782608695652173,
            ],
            [
                0.09364820846905537,
                0.09457092819614711,
                0.07184241019698726,
                0.0973630831643002,
                0.0821529745042493,
                0.0825515947467167,
                0.07252747252747253,
                0.07692307692307693,
                0.08513341804320203,
                0.09247648902821316,
                0.07958921694480103,
                0.08792650918635171,
                0.08486439195100612,
                0.07704654895666131,
                0.07860615883306321,
                0.09055627425614489,
                0.07152317880794702,
                0.09449636552440291,
                0.08379888268156424,
                0.09565857247976453,
                0.08333333333333333,
                0.09381980640357408,
                0.07856341189674523,
                0.10326566637246248,
                0.07111111111111111,
                0.08622147083685545,
                0.04242424242424243,
                0.09233997901364113,
                0.07692307692307693,
                0.08158765159867695,
                0.06320541760722348,
                0.0795593635250918,
                0.09292502639915523,
                0.07262569832402235,
                0.07971014492753623,
                0.09151414309484193,
                0.08198489751887811,
                1.0,
                0.09066427289048475,
                0.07370517928286853,
                0.07949308755760369,
                0.08634222919937205,
                0.07300884955752213,
                0.08921933085501858,
                0.08573717948717949,
                0.09008189262966333,
                0.09509011808576756,
                0.08363636363636363,
                0.06502636203866433,
                0.07375886524822695,
            ],
            [
                0.36529968454258677,
                0.34655396618985695,
                0.280997798972854,
                0.291044776119403,
                0.31659973226238286,
                0.32996632996632996,
                0.2854077253218884,
                0.22342901474010862,
                0.24627976190476192,
                0.3647566235366605,
                0.25150602409638556,
                0.24153498871331827,
                0.33053582956746286,
                0.1888446215139442,
                0.35516372795969775,
                0.24271844660194175,
                0.22740963855421686,
                0.2966804979253112,
                0.3067807768268598,
                0.3940856970428485,
                0.20357420357420358,
                0.3778580024067389,
                0.27467811158798283,
                0.3241687979539642,
                0.2128829536527887,
                0.35695876288659795,
                0.06684981684981685,
                0.2814865794907089,
                0.2187017001545595,
                0.2654494382022472,
                0.1363236587510994,
                0.24853372434017595,
                0.28888888888888886,
                0.27945402298850575,
                0.24005784526391902,
                0.19016921837228043,
                0.2836030964109782,
                0.09066427289048475,
                1.0,
                0.1361737677527151,
                0.27114967462039047,
                0.3569230769230769,
                0.12586206896551724,
                0.33489618218352313,
                0.3574547723019339,
                0.3187459177008491,
                0.4318181818181818,
                0.32086614173228345,
                0.15827922077922077,
                0.2261072261072261,
            ],
            [
                0.14992272024729522,
                0.13784665579119088,
                0.12869198312236288,
                0.15103189493433397,
                0.1384479717813051,
                0.12564991334488734,
                0.14621676891615543,
                0.10552147239263804,
                0.1326530612244898,
                0.16502649507948525,
                0.11664779161947905,
                0.11954022988505747,
                0.1589958158995816,
                0.10270270270270271,
                0.13801079414032383,
                0.13172966781214204,
                0.1276595744680851,
                0.12900188323917136,
                0.16046099290780141,
                0.15722379603399433,
                0.10927573062261753,
                0.15121255349500715,
                0.11491935483870967,
                0.14063777596075225,
                0.12435233160621761,
                0.1532258064516129,
                0.04487179487179487,
                0.14478764478764478,
                0.08816425120772947,
                0.14198782961460446,
                0.10196779964221825,
                0.12609649122807018,
                0.13789778206364514,
                0.1415289256198347,
                0.11720430107526882,
                0.09726027397260274,
                0.1377601585728444,
                0.07370517928286853,
                0.1361737677527151,
                1.0,
                0.12708333333333333,
                0.15570672713529857,
                0.08433734939759036,
                0.14322916666666666,
                0.15207373271889402,
                0.14297872340425533,
                0.16209628275441804,
                0.1437125748502994,
                0.0836940836940837,
                0.13174404015056462,
            ],
            [
                0.2803801765105227,
                0.27615658362989326,
                0.20327868852459016,
                0.24045801526717558,
                0.24649446494464944,
                0.254249815225425,
                0.225,
                0.19393382352941177,
                0.21689895470383275,
                0.29912810194500333,
                0.1920757967269595,
                0.21631205673758866,
                0.26723525230987916,
                0.1673076923076923,
                0.27309782608695654,
                0.22438162544169613,
                0.18909410729991205,
                0.24376947040498442,
                0.2616407982261641,
                0.315210355987055,
                0.1812267657992565,
                0.2972275950999355,
                0.22875816993464052,
                0.25912921348314605,
                0.17548746518105848,
                0.2712100139082058,
                0.06867469879518072,
                0.23653395784543327,
                0.20277777777777778,
                0.24205378973105135,
                0.11062431544359255,
                0.20558375634517767,
                0.2376470588235294,
                0.21307506053268765,
                0.21163575042158517,
                0.15177713736791545,
                0.2231012658227848,
                0.07949308755760369,
                0.27114967462039047,
                0.12708333333333333,
                1.0,
                0.29676985195154776,
                0.11982570806100218,
                0.2779433681073025,
                0.27639542703429726,
                0.2525179856115108,
                0.33855981416957026,
                0.2664233576642336,
                0.14328358208955225,
                0.17753623188405798,
            ],
            [
                0.39952009598080385,
                0.37254901960784315,
                0.2707365627073656,
                0.3472041612483745,
                0.3501896333754741,
                0.3475801382778127,
                0.2900262467191601,
                0.2287121745249824,
                0.254421768707483,
                0.40648967551622417,
                0.2489768076398363,
                0.26056826056826055,
                0.3622480146609652,
                0.1932471264367816,
                0.3823704586063133,
                0.2650103519668737,
                0.25453277545327757,
                0.32555123216601817,
                0.35984848484848486,
                0.425531914893617,
                0.22277580071174377,
                0.43801169590643274,
                0.28949107732980833,
                0.3810110974106042,
                0.22357142857142856,
                0.37130801687763715,
                0.0749395648670427,
                0.32054616384915474,
                0.21165857043719638,
                0.2958579881656805,
                0.13608087091757387,
                0.27346938775510204,
                0.3166449934980494,
                0.29740518962075846,
                0.2825051055139551,
                0.19361856417693982,
                0.30346631785480704,
                0.08634222919937205,
                0.3569230769230769,
                0.15570672713529857,
                0.29676985195154776,
                1.0,
                0.12423780487804878,
                0.33869969040247677,
                0.39916467780429593,
                0.37092731829573933,
                0.4915989159891599,
                0.34608266502159163,
                0.16496350364963502,
                0.23725212464589235,
            ],
            [
                0.13899920571882446,
                0.11936560934891485,
                0.11159737417943107,
                0.12464046021093,
                0.12047101449275362,
                0.12061206120612061,
                0.11261730969760167,
                0.10574412532637076,
                0.11045828437132785,
                0.11570247933884298,
                0.11483253588516747,
                0.12195121951219512,
                0.1289228159457167,
                0.09640287769784173,
                0.12056737588652482,
                0.09239766081871345,
                0.12359550561797752,
                0.12586037364798427,
                0.12053571428571429,
                0.14244396240057844,
                0.08620689655172414,
                0.1328976034858388,
                0.10970464135021098,
                0.13069139966273188,
                0.10597826086956522,
                0.13157894736842105,
                0.053268765133171914,
                0.10546875,
                0.10143042912873862,
                0.1248688352570829,
                0.06844106463878327,
                0.1082004555808656,
                0.10500490677134446,
                0.1109936575052854,
                0.11173814898419865,
                0.0841799709724238,
                0.11746680286006128,
                0.07300884955752213,
                0.12586206896551724,
                0.08433734939759036,
                0.11982570806100218,
                0.12423780487804878,
                1.0,
                0.11769911504424779,
                0.13411764705882354,
                0.1208695652173913,
                0.13194868662186926,
                0.13539823008849558,
                0.09076682316118936,
                0.10416666666666667,
            ],
            [
                0.33648393194706994,
                0.33861386138613864,
                0.25775480059084194,
                0.3061797752808989,
                0.3205216197666438,
                0.32057416267942584,
                0.25734767025089605,
                0.20125293657008614,
                0.2553846153846154,
                0.3694829760403531,
                0.24251726784343822,
                0.23141762452107278,
                0.34443704197201863,
                0.19851116625310175,
                0.33904761904761904,
                0.22803030303030303,
                0.21889400921658986,
                0.26869806094182824,
                0.3148273527420447,
                0.3591127098321343,
                0.18025078369905956,
                0.37937384898710863,
                0.2730600292825769,
                0.33508887425938116,
                0.2008,
                0.3352750809061489,
                0.07163323782234957,
                0.2800844475721323,
                0.2059748427672956,
                0.2830051057622174,
                0.10726950354609929,
                0.26717557251908397,
                0.2867281760113556,
                0.2612481857764877,
                0.23851851851851852,
                0.18610421836228289,
                0.2703281027104137,
                0.08921933085501858,
                0.33489618218352313,
                0.14322916666666666,
                0.2779433681073025,
                0.33869969040247677,
                0.11769911504424779,
                1.0,
                0.33479349186483104,
                0.3112143331121433,
                0.39713971397139713,
                0.314209472981988,
                0.17089678510998307,
                0.2143987341772152,
            ],
            [
                0.39551786795881283,
                0.3572744014732965,
                0.26492287055667335,
                0.32404406999351915,
                0.3506410256410256,
                0.3531669865642994,
                0.2965194109772423,
                0.22818311874105865,
                0.2692307692307692,
                0.4034564958283671,
                0.2522585128561501,
                0.2508735150244584,
                0.38427672955974845,
                0.20088300220750552,
                0.39416058394160586,
                0.25977653631284914,
                0.24123422159887797,
                0.3075924724205062,
                0.33647798742138363,
                0.44287396937573614,
                0.22125813449023862,
                0.41525917297612114,
                0.2813333333333333,
                0.3631319358816276,
                0.22294843863471314,
                0.3720219914477703,
                0.06792144026186579,
                0.3258278145695364,
                0.22994269340974213,
                0.3148273527420447,
                0.12667191188040913,
                0.2780859916782247,
                0.316622691292876,
                0.285809906291834,
                0.26621160409556316,
                0.19335793357933578,
                0.30066225165562915,
                0.08573717948717949,
                0.3574547723019339,
                0.15207373271889402,
                0.27639542703429726,
                0.39916467780429593,
                0.13411764705882354,
                0.33479349186483104,
                1.0,
                0.35615577889447236,
                0.4750812567713976,
                0.34984326018808776,
                0.16679076693968728,
                0.22364672364672364,
            ],
            [
                0.35800126502213786,
                0.33811074918566775,
                0.27601476014760146,
                0.29444063143445437,
                0.3026052104208417,
                0.3096989966555184,
                0.2482468443197756,
                0.22448979591836735,
                0.23454951600893523,
                0.36267823930564164,
                0.24715693707354056,
                0.22139117427075541,
                0.3359477124183007,
                0.18,
                0.35641677255400256,
                0.24772727272727274,
                0.2322383498854087,
                0.2902777777777778,
                0.3137516688918558,
                0.38382619191309597,
                0.19968676585747847,
                0.3817629179331307,
                0.2661406025824964,
                0.32601678502259523,
                0.19670846394984326,
                0.33312061263560944,
                0.06592386258124419,
                0.2920168067226891,
                0.21495327102803738,
                0.2841726618705036,
                0.12533097969991175,
                0.26957831325301207,
                0.29324894514767935,
                0.2546230440967283,
                0.252212389380531,
                0.16706634692246203,
                0.265406162464986,
                0.09008189262966333,
                0.3187459177008491,
                0.14297872340425533,
                0.2525179856115108,
                0.37092731829573933,
                0.1208695652173913,
                0.3112143331121433,
                0.35615577889447236,
                1.0,
                0.4255555555555556,
                0.3288948069241012,
                0.1691542288557214,
                0.22816679779701024,
            ],
            [
                0.49448732083792724,
                0.44561016013252347,
                0.328505214368482,
                0.383399209486166,
                0.4163380281690141,
                0.4057971014492754,
                0.35023041474654376,
                0.26654740608228983,
                0.28587962962962965,
                0.48017148981779206,
                0.2887981330221704,
                0.27658338175479374,
                0.4480843975569128,
                0.21080760095011877,
                0.4845984598459846,
                0.28846153846153844,
                0.2768328445747801,
                0.3714609286523216,
                0.4066666666666667,
                0.5376749192680301,
                0.23730814639905548,
                0.5179240235420011,
                0.34936268829663963,
                0.4345205479452055,
                0.23217442545668826,
                0.4544956140350877,
                0.07470182046453233,
                0.3679727427597956,
                0.24283206553540082,
                0.3301245753114383,
                0.1316923076923077,
                0.3119533527696793,
                0.3515185601799775,
                0.33793103448275863,
                0.31130434782608696,
                0.2119760479041916,
                0.3456299659477866,
                0.09509011808576756,
                0.4318181818181818,
                0.16209628275441804,
                0.33855981416957026,
                0.4915989159891599,
                0.13194868662186926,
                0.39713971397139713,
                0.4750812567713976,
                0.4255555555555556,
                1.0,
                0.41124586549062847,
                0.1771019677996422,
                0.251472320376914,
            ],
            [
                0.323238566131026,
                0.3473684210526316,
                0.260424286759327,
                0.29120879120879123,
                0.2934131736526946,
                0.32070365358592695,
                0.2590489709013485,
                0.208398133748056,
                0.2449133383571967,
                0.36743605739238927,
                0.23048048048048048,
                0.23726235741444868,
                0.3208036292935839,
                0.19140308191403083,
                0.344914718888187,
                0.24980959634424982,
                0.21009036144578314,
                0.29964912280701755,
                0.32836831415030465,
                0.3629320619785459,
                0.21400159108989658,
                0.3856968215158924,
                0.2700361010830325,
                0.3272845106934543,
                0.19387755102040816,
                0.3447385409941898,
                0.07230046948356808,
                0.29507042253521126,
                0.2188235294117647,
                0.2563559322033898,
                0.12599822537710736,
                0.26601356443104746,
                0.2702702702702703,
                0.26931407942238267,
                0.2514792899408284,
                0.17542441390460792,
                0.2709950599858857,
                0.08363636363636363,
                0.32086614173228345,
                0.1437125748502994,
                0.2664233576642336,
                0.34608266502159163,
                0.13539823008849558,
                0.314209472981988,
                0.34984326018808776,
                0.3288948069241012,
                0.41124586549062847,
                1.0,
                0.16514522821576763,
                0.21389539422326306,
            ],
            [
                0.1656671664167916,
                0.15939730372720062,
                0.13813813813813813,
                0.14210061782877317,
                0.15378079864061173,
                0.16453537936913895,
                0.12606635071090047,
                0.11649365628604383,
                0.14010695187165775,
                0.1731190650109569,
                0.13714902807775378,
                0.1145610278372591,
                0.1757085020242915,
                0.12055837563451777,
                0.1636500754147813,
                0.14301191765980498,
                0.12942477876106195,
                0.15934065934065933,
                0.16610169491525423,
                0.17634854771784234,
                0.12305854241338113,
                0.18882602545968882,
                0.13773035887487875,
                0.16031746031746033,
                0.10781990521327015,
                0.1649805447470817,
                0.045112781954887216,
                0.1422060164083865,
                0.13615023474178403,
                0.15937803692905733,
                0.0928,
                0.16012725344644752,
                0.16542056074766356,
                0.15924826904055392,
                0.14256198347107438,
                0.10292249047013977,
                0.17052023121387283,
                0.06502636203866433,
                0.15827922077922077,
                0.0836940836940837,
                0.14328358208955225,
                0.16496350364963502,
                0.09076682316118936,
                0.17089678510998307,
                0.16679076693968728,
                0.1691542288557214,
                0.1771019677996422,
                0.16514522821576763,
                1.0,
                0.13200934579439252,
            ],
            [
                0.21857142857142858,
                0.21005251312828208,
                0.1741112123974476,
                0.20116375727348296,
                0.19572107765451663,
                0.1935483870967742,
                0.18495575221238938,
                0.1632016632016632,
                0.1943081452404318,
                0.22183588317107092,
                0.176930596285435,
                0.18136769078295342,
                0.21808510638297873,
                0.16179775280898875,
                0.21782890007189074,
                0.1686046511627907,
                0.1626984126984127,
                0.19477234401349072,
                0.2138314785373609,
                0.23384410393071287,
                0.13174273858921162,
                0.24625850340136055,
                0.17898486197684774,
                0.20193740685543965,
                0.16025641025641027,
                0.22255192878338279,
                0.05522388059701493,
                0.2103448275862069,
                0.15360824742268042,
                0.1883289124668435,
                0.10317460317460317,
                0.15598885793871867,
                0.1958939264328486,
                0.194043321299639,
                0.1660482374768089,
                0.13348164627363737,
                0.18782608695652173,
                0.07375886524822695,
                0.2261072261072261,
                0.13174404015056462,
                0.17753623188405798,
                0.23725212464589235,
                0.10416666666666667,
                0.2143987341772152,
                0.22364672364672364,
                0.22816679779701024,
                0.251472320376914,
                0.21389539422326306,
                0.13200934579439252,
                1.0,
            ],
        ]
    )


def test_std() -> None:
    fps = make_fake_fingerprints(1000, seed=1345)
    std = estimate_jt_std(fps)
    sample = jt_stratified_sampling(fps, n_samples=50)
    matrix = jt_sim_matrix_packed(fps[sample])
    assert (std == np.std(matrix[~np.eye(len(matrix), dtype=bool)])).all()
